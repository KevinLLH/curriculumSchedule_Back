<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>


    <meta http-equiv="proma" content="no-cache"/>
    <meta http-equiv="cache-control" content="no cache"/>
    <meta http-equiv="expires" content="0"/>


    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>教务管理系统</title>
    <!-- BOOTSTRAP STYLES-->
    <link href="assets/css/bootstrap.css" rel="stylesheet"/>
    <!-- FONTAWESOME STYLES-->
    <link href="assets/css/font-awesome.css" rel="stylesheet"/>
    <!-- CUSTOM STYLES-->
    <link href="assets/css/custom.css" rel="stylesheet"/>
    <!-- GOOGLE FONTS-->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>


    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

    <script type="text/javascript">


        var xqxn;
        var kc;
        var code;
        var ip = "localhost:80";
        var code1;
        $(function () {

            <!--11111111111111111111111111111111111111111111111111111111111111111111111111-->
            <!--学期学年触发课程下拉框-->
            $("#sel_XNXQ").change(function (e) {
                $("#displayCode").css("display", "none");
                xqxn = e.target.value;
                var obj = {
                        type: "GET",
                        url: "http://" + ip + "/course/" + xqxn + "/courseList"
                    }
                ;

                $.ajax(obj).done(function (res1) {
                    createSelect(res1);
                });

            });

            function createSelect(res1) {
                $("#sel_kc").empty();
                var option1 = "<option>选择课程</option>";
                $("#sel_kc").append(option1);
                for (i = 0; i < res1.length; i++) {
                    var user = res1[i];
                    var option = "<option value=" + user.listValue + ">" + user.listName + "</option>";
                    $("#sel_kc").append(option);
                }

            }

            <!--222222222222222222222222222222222222222222222222222222222222222222222222-->
            <!--获取课程信息的触发事件-->
            $("#sel_kc").change(function (e) {
                $("#displayCode").css("display", "none");
                kc = e.target.value;

            });

            $("#showLesson").on("click", function () {


                code = $("#text_code").val();
                if (code.length == 0 || code == code1) {
                    code = "isNUll";
                }

                alert("***********************")
                <!--当每次点击button时，我们刷新table-->
                $("table tr td").remove();

                <!--向服务器发送post请求 data:JSON.stringify({"term":"20161",course:"221918",yzm:"sstx"})强转json文件-->
                var obj = {
                    contentType: "application/json; charset=utf-8",
                    type: "POST",
                    url: "http://" + ip + "/course/queryClassByCourse",
                    data: JSON.stringify({term: xqxn, course: kc, yzm: code})
                };
                code1 = code;
                $.ajax(obj).done(function (res) {

                    if (res['success'] && res['error'] == null) {
                        $("#displayCode").css("display", "none");
                        code = "";
                        alert(code);
                        createTable(res['data']);
                    } else {

                        var error = res['error'];
                        alert(error);

                        $("#displayCode").css("display", "inline");
                        $("#imgCode").attr("src", "http://" + ip + "/course/getVerImg?" + Math.random());
                        return;
                    }

                });


                <!--插入數據到表中-->
                function createTable(res) {
                    for (var i = 0; i < res.length; i++) {

                        var user = res[i];
                        var table = "<tr> <td>" + user.week + "</td>" + "<td>" + user.lesson + "</td>" + "<td>" + user.info + "</td>"
                        $("#userList").append(table);
                    }
                }


            })


        });


        <!--button按一次，多次按不触发-->
        function onlyone(o) {

            o.onclick = function () {
            };
        }


    </script>
</head>
<body>
<div id="wrapper">
    <nav class="navbar navbar-default navbar-cls-top " role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">首页</a>
        </div>
        <div style="color: white;
padding: 15px 50px 5px 50px;
float: right;
font-size: 30px; text-center"> 重庆工商职业技术学院
        </div>
    </nav>
    <!-- /. NAV TOP  -->
    <nav class="navbar-default navbar-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav" id="main-menu">
                <li class="text-center">
                    <img src="assets/img/find_user.png" class="user-image img-responsive"/>
                </li>

                <li>
                    <a href="lesson.html"><i class="fa fa-dashboard fa-3x"></i> 课程课表</a>
                </li>
                <li>
                    <a href="teacher.html"><i class="fa fa-desktop fa-3x"></i> 教师课表</a>
                </li>
                <li>
                    <a href="classroom.html"><i class="fa fa-qrcode fa-3x"></i> 教室课表</a>
                </li>
                <li>
                    <a href="random.html"><i class="fa fa-bar-chart-o fa-3x"></i> 任选课表</a>
                </li>
            </ul>

        </div>

    </nav>
    <!-- /. NAV SIDE  -->
    <div id="page-wrapper">
        <div id="page-inner">
            <div class="row">
                <div class="col-md-12 text-center">
                    <h1>课程课表</h1>
                    <div>
                        <tr>
                            <td>学期学年&nbsp;<select id="sel_XNXQ" style='WIDTH:165px;height:40px'>
                                <option>选择学年</option>
                                <option value="20161">2016-2017学年第二学期</option>
                                <option value="20160">2016-2017学年第一学期</option>
                                <option value="20151">2015-2016学年第二学期</option>
                                <option value="20150">2015-2016学年第一学期</option>
                                <option value="20141">2014-2015学年第二学期</option>
                                <option value="20140">2014-2015学年第一学期</option>
                            </select></td>
                            <td>&nbsp;课程：<select name="sel_kc" id="sel_kc" style='WIDTH:165px;height:40px'>
                            </select>&nbsp;
                            </td>
                            <p style="display:none" id="displayCode">
                            <td id="hideYzm">验证码：<input type="text" id="text_code"
                                                        style="WIDTH:100px;height:40px;color:'#999'"
                                                        onclick="this.value=''"/></td>&nbsp;<td><img id="imgCode" src=""
                                                                                                     style="height:40px"></p>
                            <button class="btn btn-info btn-lg" id="showLesson" onclick="onlyone(this)">查看</button>
                        </td>
                        </tr>

                    </div>
                </div>
            </div>
            <!-- /. ROW  -->
            <hr/>
            <div class="table-responsive">
                <!--添加table77777777777777777777777777777777777777777-->

                <table id="userList" class="table table-striped table-bordered  table-layout:fixed ;">
                    <tr>
                        <th class="text-center ">星期</th>
                        <th class="text-center">节课</th>
                        <th class="text-center">信息</th>
                    </tr>
            </div>


        </div>
        <!-- /. PAGE INNER  -->
    </div>
    <!-- /. PAGE WRAPPER  -->
</div>
<!-- /. WRAPPER  -->
<!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
<!-- JQUERY SCRIPTS -->
<!-- <script src="assets/js/jquery-1.10.2.js"></script>
   <!-- BOOTSTRAP SCRIPTS -->
<!--<script src="assets/js/bootstrap.min.js"></script>
<!-- METISMENU SCRIPTS -->
<!--<script src="assets/js/jquery.metisMenu.js"></script>
  <!-- CUSTOM SCRIPTS -->
<!--<script src="assets/js/custom.js"></script> -->


</body>
</html>
